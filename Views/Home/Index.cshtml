@model CheckinPortal.Models.ReservationModel
@{
    var ProfileList = (List<CheckinPortal.Models.Profile>)Model.Profiles;
    var primaryProfile = ProfileList[0];

    var PackageList = (List<CheckinPortal.Models.PackageMasterModal>)ViewBag.PackageList;

    var PackageListForRoomUpsell = PackageList.Where(x => x.IsRoomUpsell).ToList();
    var PackageListForSpecials = PackageList.Where(x => x.IsRoomUpsell == false).ToList();

    string RoomUpsellPackages = ViewBag.RoomUpsellPackages;
    string SpecialPackages = ViewBag.SpecialPackages;

}
@*@{var docurl = System.Configuration.ConfigurationManager.AppSettings["OCRAPIBaseURL"]; }*@

<script>
    var AdaptorAPIBaseURL = "@ViewBag.AdaptorAPIBaseURL";
    var OCRAPIBaseURL = "@ViewBag.OCRAPIBaseURL";
        ReservationNumber = "@Model.ReservationNumber"
        ReservationNameID = "@Model.ReservationNameID"
        var IsDepositAvailable = "@Model.IsDepositAvailable";
        var TotalRoomRate = "@Model.TotalRoomRate";
        var TotalSpecialCharges = 0;
        var selectedUpsellPackage = [];
        var selectedSpecialPackage = [];


        selectedUpsellPackage = "@RoomUpsellPackages".split(",")
        selectedSpecialPackage = "@SpecialPackages".split(",")


        selectedUpsellPackage = selectedUpsellPackage.filter(function (value, index, arr) {
            return value != "";
        });

        selectedSpecialPackage = selectedSpecialPackage.filter(function (value, index, arr) {
            return value != "";
        });

</script>

<style>
    .adyen-checkout__button__text
    {
        width: 100% !important;
    }
</style>




<link href="~/assets/css/additionalStyles.css" rel="stylesheet" />
@*<div class="fxd-tab">
        <div class="container">
            <div class="steps-wrap">
                <div class="row">
                    @{ int PageNo = 1;}
                    <div class="col">
                        <a class="d-flex justify-content-center active tabs @(ViewBag.PaymentProcessed ? "paymentdone active " : "")" href="#guestDetails">
                            <div class="count">
                                <span class="number">@PageNo</span><span class="value">GUEST DETAILS</span>
                            </div>
                        </a>
                    </div>
                    @{ PageNo++;}
                    <div class="col">
                        <a class="d-flex justify-content-center tabs @(ViewBag.PaymentProcessed ? "paymentdone active" : "")" href="#upgrade">
                            <div class="count">
                                <span class="number">@PageNo</span><span class="value">Upgrade</span>
                            </div>
                        </a>
                    </div>
                    @{ PageNo++;}
                    <div class="col">
                        <a class="d-flex justify-content-center tabs @(ViewBag.PaymentProcessed ? "paymentdone active" : "")" href="#policies">
                            <div class="count">
                                <span class="number">@PageNo</span><span class="value">Policies</span>
                            </div>
                        </a>
                    </div>
                    @if (!Model.IsDepositAvailable)
                    {
                        PageNo++;
                        <div class="col">
                            <a class="d-flex justify-content-center tabs @((ViewBag.PaymentProcessed && ViewBag.IsPaymentSuccess) ? "paymentdone active" : "")" href="#payment">
                                <div class="count">
                                    <span class="number">4</span><span class="value">Payment</span>
                                </div>
                            </a>
                        </div>
                    }
                    @{ PageNo++;}
                    <div class="col">
                        <a class="d-flex justify-content-center tabs @((ViewBag.PaymentProcessed && ViewBag.IsPaymentSuccess) ? "paymentdone active" : "")" href="#document">
                            <div class="count">
                                <span class="number">@PageNo</span><span class="value">Document</span>
                            </div>
                        </a>
                    </div>
                    @{ PageNo++;}
                    <div class="col">
                            <a class="d-flex justify-content-center tabs" href="#Questions">
                                <div class="count">
                                    <span class="number">@PageNo</span><span class="value">Declaration</span>
                                </div>
                            </a>
                        </div>
                    <div class="col">
                            <a class="d-flex justify-content-center tabs" href="#qrCode">
                                <div class="count">
                                    <span class="number">7</span><span class="value">Finish</span>
                                </div>
                            </a>
                        </div>
                </div>
            </div>
        </div>
    </div>*@
<div class="offset-md-0 col-md-3 offset-lg-0 col-lg-3  offset-xl-1 col-xl-2 left-menu h100">
    <div class="space"></div>
    <div class="menu">
        <div class="logo"> <img class="img-fluid" src="~/assets/images/logo.png"></div>
        @{ int PageNo = 1;}
        <ul>
            <li class="active @(ViewBag.PaymentProcessed ? "paymentdone active " : "") tabs"><a href="#guestDetails"><label>Guest Details</label><span class="count">@PageNo</span></a></li>
            @{ PageNo++;}
            <li class="@(ViewBag.PaymentProcessed ? "paymentdone active" : "") tabs"><a href="#upgrade"><label>Upgrade</label><span class="count">@PageNo</span></a></li>
            @{ PageNo++;}
            <li class="@(ViewBag.PaymentProcessed ? "paymentdone active" : "") tabs"><a href="#policies"><label>Policies</label><span class="count">@PageNo</span></a></li>
            @{ PageNo++;}
            @if (!Model.IsDepositAvailable)
            {
                <li class="@((ViewBag.PaymentProcessed && ViewBag.IsPaymentSuccess) ? "paymentdone active" : "") tabs"><a href="#payment"><label>Payment</label><span class="count">@PageNo</span></a></li>
            }
            @{ PageNo++;}
            <li class="@((ViewBag.PaymentProcessed && ViewBag.IsPaymentSuccess) ? "paymentdone active" : "") tabs"><a href="#document"><label>Document</label><span class="count">@PageNo</span></a></li>
        </ul>
    </div>
</div>
<div class="col-md-9 col-lg-9 col-xl-9 h100 room-bg">
    <div class="row">
        <div class="col-md-11 col-lg-11 col-xl-9  pd-0">
            <div class="content-wrapper cstm-form">
                <div class="min-height">
                    <div class="tab-content">
                        <div class="tab-pane cstm-form @(ViewBag.PaymentProcessed ? "paymentdone" : "active") " id="guestDetails">
                            <form id="frm_guestdetails" name="frm_guestdetails">

                                @Html.HiddenFor(model => model.ReservationID)
                                @Html.HiddenFor(model => model.AdultCount)
                                @Html.HiddenFor(model => model.ChildCount)
                                @Html.HiddenFor(model => model.ReservationNumber)
                                @if (Model.Profiles.Count > 0)
                                {
                                    @Html.HiddenFor(model => model.Profiles[0].ProfileDetailID)
                                }
                                @if (Model.Profiles.Count > 1)
                                {
                                    @Html.HiddenFor(model => model.Profiles[1].ProfileDetailID)
                                }
                                @if (Model.Profiles.Count > 2)
                                {
                                    @Html.HiddenFor(model => model.Profiles[2].ProfileDetailID)
                                }

                                <h1>GUEST DETAILS</h1>
                                <div class="detail-wrapper">
                                    <ul>
                                        <li>
                                            <label>ROOM TYPE</label>
                                            <span>@Model.RoomTypeDescription</span>
                                        </li>
                                        <li>
                                            <label>CHECK-IN DATE</label>
                                            <span>@Model.ArrivalDate</span>
                                        </li>
                                        <li>
                                            <label>CHECK-OUT DATE</label>
                                            <span>@Model.DepartureDate</span>@*02 June 2020*@
                                        </li>
                                        <li>
                                            <label>Adult/Child</label>
                                            <span>@Model.AdultCount / @Model.ChildCount</span>
                                        </li>
                                    </ul>
                                </div>
                                <!-- details -->
                                <h2>Personal Information</h2>
                                <div class="form-row">
                                    <div class="form-group col-md-6 col-lg-4">
                                        <label>Email  Address <span class="error">*</span></label>
                                        @Html.TextBoxFor(model => model.Profiles[0].Email, new { @class = "form-control", type = "email" })
                                        @*<input type="email" class="form-control" value="@primaryProfile.Email" id="email" name="Profile[0].Email">*@
                                    </div>
                                    <div class="form-group col-md-6 col-lg-4">
                                        <label>Phone Number <span class="error">*</span></label>
                                        @Html.TextBoxFor(model => model.Profiles[0].Phone, new { @class = "form-control", type = "number" })
                                        @*<input type="number" class="form-control" id="phone" name="Profile[0].Phone" value="@primaryProfile.Phone">*@
                                    </div>
                                    <div class="form-group col-md-6 col-lg-4">
                                        <label>Address <span class="error">*</span></label>
                                        @Html.TextBoxFor(model => model.Profiles[0].AddressLine1, new { @class = "form-control" })
                                        @*<input type="text" class="form-control" id="address" name="Profile[0].AddressLine1" value="@primaryProfile.AddressLine1">*@
                                    </div>
                                    @*</div>*@
                                    @*<div class="form-row">*@
                                    <div class="form-group col-md-6 col-lg-4">
                                        <label>Country  <span class="error">*</span></label>
                                        @Html.DropDownListFor(model => model.Profiles[0].CountryID, (SelectList)ViewBag.CountryList, "Select Country", new { @class = "form-control selectpicker selectCountry", @data_live_search = "true" })
                                        @*<select class="form-control selectpicker" id="country" name="country">
                                                <option>Singapore</option>
                                            </select>*@
                                    </div>
                                    <div class="form-group col-md-6 col-lg-4">
                                        <label>State  <span class="error"></span></label>
                                        @Html.DropDownListFor(model => model.Profiles[0].StateID, (SelectList)ViewBag.StateList, "Select State", new { @class = "form-control selectpicker state", @data_live_search = "true" })

                                        @*<select class="selectpicker form-control" id="state" name="state"></select>*@
                                    </div>
                                    <div class="form-group col-md-6 col-lg-4">
                                        <label>City  <span class="error">*</span></label>
                                        @Html.TextBoxFor(model => model.Profiles[0].City, new { @class = "form-control" })
                                        @*<input type="text" class="form-control" id="city" name="city" @Model.Profiles[0].City>*@
                                    </div>

                                    @*</div>
                                        <div class="form-row">*@
                                    <div class="form-group col-md-6 col-lg-4">
                                        <label>Postal Code  <span class="error">*</span></label>
                                        @Html.TextBoxFor(model => model.Profiles[0].PostalCode, new { @class = "form-control", value = "1212" })
                                    </div>
                                    @*<div class="form-group col-md-4">
                                            <label>ALL Membership Number<a class="info" href="#" data-toggle="tooltip" title="Accor Live Limitless membership no."></a></label>
                                            @Html.TextBoxFor(model => model.MembershipNo, new { @class = "form-control", onchange = "enableDisableMembershipCheckbox()" })
                                        </div>
                                        <div class="form-group col-md-4">
                                            <div class="form-check chk-cu">
                                                @Html.CheckBoxFor(model => model.IsMembershipRequested, new { @class = "form-check-input", onchange = "enableDisableMembership(this.checked)" })
                                               <label class="form-check-label" for="IsMembershipRequested">
                                                    I would like to be invited for complimentary ALL membership.
                                                </label>
                                            </div>
                                        </div>*@
                                    <div class="form-group col-md-6 col-lg-4">
                                        <label>Flight Number</label>
                                        @Html.TextBoxFor(model => model.FlightNo, new { @class = "form-control" })
                                        @*<input type="text" class="form-control" id="flightno" name="flightno" value="@Model.FlightNo">*@
                                    </div>
                                    <div class="form-group col-md-6 col-lg-4 time-cstm">
                                        <label>Expected Arrival Time(Hotel)  <span class="error">*</span></label>
                                        @Html.TextBoxFor(model => model.ExpectedTimeofArrival, new { @class = "form-control", id = "timepicker1", type = "time" })
                                        <span> Official Hotel Check In Time is 15:00 hrs.</span>

                                        @*<span>Hotel Check In Time is 03.00pm</span>*@
                                        @*<input type="time" id="timepicker1" class="form-control" name="expected_arrival" value="@Model.ExpectedTimeofArrival">*@
                                    </div>
                                </div>

                                @*<div class="form-sep">
                                        <img src="~/assets/images/plane_icon.png">
                                    </div>
                                    <h2>FLIGHT INFORMATION</h2>*@
                                <!--<div class="form-row">
                                    <div class="form-group col-md-4">
                                        <label>Flight Number</label>
                                        @Html.TextBoxFor(model => model.FlightNo, new { @class = "form-control" })-->
                                @*<input type="text" class="form-control" id="flightno" name="flightno" value="@Model.FlightNo">*@
                                <!--</div>
                                <div class="form-group col-md-4 time-cstm">
                                    <label>Expected Arrival Time(Hotel)  <span class="error">*</span></label>
                                    @Html.TextBoxFor(model => model.ExpectedTimeofArrival, new { @class = "form-control", id = "timepicker1", type = "time" })
                                    <span>Hotel Check In Time is 03.00pm</span>-->
                                @*<input type="time" id="timepicker1" class="form-control" name="expected_arrival" value="@Model.ExpectedTimeofArrival">*@
                                <!--</div>
                                </div>-->
                                <div class="row">
                                    <div class="col-lg-6 col-xl-4 offset-xl-8 offset-lg-6">
                                        <div class="btn-grp d-flex justify-content-between">
                                            @*<button class="btn_cancel">Back</button>*@
                                            <button type="button" class="btn_next " onclick="SaveReservationAndMoveNext(this)">Next<img src="~/assets/images/arrow_icon.png"></button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="tab-pane cstm-form @(ViewBag.PaymentProcessed ? "paymentdone" : "")" id="upgrade">
                            <h1>Upgrade</h1>
                            <h2>ROOM UPGRADE  <span style="text-transform:none">(Subject to availability)</span></h2>
                            <div class="row">
                                @foreach (var package in PackageListForRoomUpsell)
                                {
                                    var url = $"data:image/png;base64,{Convert.ToBase64String(package.PackageImage)}";
                                    var isUpsellSelected = ((List<CheckinPortal.Models.ReservationPackageModel>)ViewBag.ReservationPackagesList).Any(x => x.PackageID == package.PackageID);


                                    <div class="col-md-6 col-lg-4 col-xl-3 @package.PackageID">
                                        <div class="upg-wrap">
                                            <div class="upgrade">
                                                <span class="tick" data-upselltype="Upsell" style="display:@(isUpsellSelected ? "block" : "none")"></span>
                                                <img class="img-fluid" src="@url">
                                            </div>
                                            <div class="btn-wrap" style="height:120px">
                                                <div class="row">
                                                    <div class="col"><label>@package.PackageName</label> </div>
                                                    <div class="col-auto">
                                                        <a href="#/" class="selectUpsell" onclick="showUpsellPopup(this,'Upsell')">DETAILS</a>
                                                        <input type="hidden" value="@package.PackageName" class="upsellPackageName" />
                                                        <input type="hidden" value="@url" class="upsellImage" />
                                                        <input type="hidden" value="@package.PackageAmount" class="packageAmount" />
                                                        <input type="hidden" value="@package.PackageCode" class="packageCode" />
                                                        <input type="hidden" value="@package.PackageDesc" class="packageDesc" />
                                                        <input type="hidden" value="@package.PackageID" class="packageID" />
                                                        <input type="hidden" value="@package.Units" class="packageUnits" />
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }

                            </div>
                            <h2>Specials <span style="text-transform:none">(Instant confirmation)</span></h2>
                            <div class="row">

                                @foreach (var package in PackageListForSpecials)
                                {
                                    string url = string.Empty;
                                    if (package.PackageImage != null)
                                    {
                                        url = $"data:image/png;base64,{Convert.ToBase64String(package.PackageImage)}";
                                    }

                                    var isUpsellSelected = ((List<CheckinPortal.Models.ReservationPackageModel>)ViewBag.ReservationPackagesList).Any(x => x.PackageID == package.PackageID);

                                    <div class="col-md-6 col-lg-4 col-xl-3 @package.PackageID">
                                        <div class="upg-wrap">
                                            <div class="upgrade">
                                                <span class="tick" data-upselltype="Package" style="display:@(isUpsellSelected ? "block" : "none")"></span>
                                                <img class="img-fluid" src="@url">
                                            </div>
                                            <div class="btn-wrap" style="height:120px">
                                                <div class="row">
                                                    <div class="col"><label>@package.PackageName</label> </div>
                                                    <div class="col-auto">
                                                        <a href="#/" class="selectUpsell" onclick="showUpsellPopup(this,'Package')">DETAILS</a>
                                                        <input type="hidden" value="@package.PackageName" class="upsellPackageName" />
                                                        <input type="hidden" value="@url" class="upsellImage" />
                                                        <input type="hidden" value="@package.PackageAmount" class="packageAmount" />
                                                        <input type="hidden" value="@package.PackageCode" class="packageCode" />
                                                        <input type="hidden" value="@package.PackageDesc" class="packageDesc" />
                                                        <input type="hidden" value="@package.PackageID" class="packageID" />
                                                        <input type="hidden" value="@package.Units" class="packageUnits" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>

                            <div class="message" id="upgradeTerms" style="display:none">
                                Room Upgrade request is subject to availability. Our team will contact you on the status.<br />
                                <div>
                                    <input type="checkbox" value="1" id="upgradeTermsCheckbox" /> By checking this box, I acknowledge and agree for my credit card to be charged the additional fees should my requested room upgrade be available.
                                </div>
                            </div>

                            <div class="message" id="upgradeTermsSpecials" style="display:none">
                                Request for Specials is confirmed instantly and your card will be charged in the next page.<br />
                            </div>

                            <div class="row">
                                <div class="col-lg-6 col-xl-4 offset-xl-8 offset-lg-6">
                                    <div class="btn-grp d-flex justify-content-between">
                                        <button class="btn_cancel" value='Back'>Back</button>
                                        <button class="btn_next " onclick="savePackages(this)">Next<img src="~/assets/images/arrow_icon.png"></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane  cstm-form @(ViewBag.PaymentProcessed ? "paymentdone" : "") " id="policies">

                            <h1>Policies</h1>
                            @*<h2 class="mb-none">Policies</h2>*@
                            <div class="plcy-wrapper">
                                <div class="row">
                                    <div class="col-xl-6">
                                        <div class="form-group row">
                                            <label class="col-7 col-lg-4 col-xl-4">Confirmation Number</label>
                                            <div class="col-5 col-lg-8 col-xl-8">
                                                <span>@Model.ReservationNumber</span>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-7 col-lg-4 col-xl-4">Room Type</label>
                                            <div class="col-5 col-lg-8 col-xl-8">
                                                <span>@Model.RoomTypeDescription</span>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-7 col-lg-4 col-xl-4">Check-in Date</label>
                                            <div class="col-5 col-lg-8 col-xl-8">
                                                <span>@Model.ArrivalDate</span>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-7 col-lg-4 col-xl-4">Check-out Date</label>
                                            <div class="col-5 col-lg-8 col-xl-8">
                                                <span>@Model.DepartureDate</span>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-7 col-lg-4 col-xl-4">ADULT/CHILD</label>
                                            <div class="col-5 col-lg-8 col-xl-8">
                                                <span>@Model.AdultCount / @Model.ChildCount</span>
                                            </div>
                                        </div>

                                        @*<div class="form-group row">
                                                <label class="col-7 col-lg-4 col-xl-4">Avg. Room Rate </label>
                                                <div class="col-5 col-lg-8 col-xl-8">
                                                    <span>SGD @Model.AverageRoomRate.ToString("0.00")</span>
                                                </div>
                                            </div>*@
                                        <div class="form-group row">
                                            <label class="col-7 col-lg-4 col-xl-4">Breakfast</label>
                                            <div class="col-5 col-lg-8 col-xl-8">
                                                <span>@(Model.IsBreakFastAvailable ? "Included" : "Not Included")</span>
                                            </div>
                                        </div>
                                        <hr>
                                        <div class="form-group row total">
                                            <label class="col-7 col-lg-4 col-xl-4">TOTAL CHARGES</label>
                                            <div class="col-5 col-lg-8 col-xl-8">

                                                @{
                                                    var totalcharge = "--";

                                                    if (Model.TotalRoomRate > 0)
                                                    {
                                                        totalcharge = "SGD " + Model.TotalRoomRate.ToString("0.00") + "<span> (Inclusive of 10% service charge and prevailing government taxes)</span>";
                                                    }
                                                }


                                                <span id="spanTotalCharges">@totalcharge <span> (Inclusive of 10% service charge and prevailing government taxes)</span></span>
                                            </div>
                                        </div>
                                        @*<div class="form-group row total" style=" margin-top: -20px; line-height: 15px;">
                                                <div class="col-10 col-lg-10 col-xl-10">
                                                    <span><span style="margin-left: -5px;">Note: Incidental fees are to cover any additional cost that may be incurred during your stay and any unused fees will be fully refunded to your Credit Card at the end of your stay. For guests using Debit Cards for payment, incidental fees will not be charged and an alternative form of deposit for incidental fees is required on arrival. Any selected room upgrade will only be charged upon availability confirmation.</span></span>
                                                </div>
                                            </div>*@
                                        @*<br />
                                            <div class="form-group row total" style=" margin-top: -20px; line-height: 15px;">
                                                <div class="col-10 col-lg-10 col-xl-10">
                                                    <span>
                                                        <span style="margin-left: -5px;">
                                                            <b>
                                                                In adherence to Singapore Government regulations, please be reminded that no more than 5 persons including the registered guests are allowed in a guestroom at any point of time.
                                                                Thank you in advance for your cooperation.
                                                            </b>
                                                        </span>
                                                    </span>
                                                </div>
                                            </div>*@
                                    </div>
                                    <div class="col-xl-5 sign-here">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="receviceUpdate" name="checkbox1">
                                            <label class="form-check-label" for="receviceUpdate">
                                                I would like to receive information and updates from Dsuite.
                                            </label>

                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="chkFine" name="checkbox2">
                                            <label class="form-check-label" for="chkFine">
                                                <font color="red">*</font>The hotel is a smoke-free hotel. A cleaning fee of S$275 nett per incident will be charged to a guest smoking in the room and/or within the hotel premises.
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="IsTermsAndConditionAccepted" name="IsTermsAndConditionAccepted" value="True">
                                            <label class="form-check-label" for="acceptTermsAndCondition">
                                                <font color="red">*</font>I agree to the <a href="#" data-toggle="modal" data-target="#termsAndConditionModal">terms and conditions</a>
                                            </label>
                                        </div>
                                        <div class="sign" style="max-width:350px;width:auto">
                                            <div id="signature-pad" class="signature-pad">
                                                <div class="signature-pad--body">
                                                    <canvas></canvas>
                                                </div>
                                                <div class="signature-pad--footer">
                                                    <div class="signature-pad--actions">
                                                        <div class="buttons">
                                                            <button type="button" class="button clear" data-action="clear">Clear</button>
                                                        </div>
                                                        <div class="description">Sign above</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6 col-xl-4 offset-xl-8 offset-lg-6">
                                    <div class="btn-grp d-flex justify-content-between">
                                        <button class="btn_cancel" value='Back'>Back</button>
                                        <button class="btn_next" onclick="return SavePolicies(this)">Next<img src="~/assets/images/arrow_icon.png"></button>
                                    </div>
                                </div>
                            </div>

                        </div>
                        @if (!Model.IsDepositAvailable)
                        {
                            <div class="tab-pane cstm-form @((ViewBag.PaymentProcessed && !ViewBag.IsPaymentSuccess) ? "active" : "paymentdone")" id="payment">
                                <h1>PAYMENT</h1>
                                @*<h2 class="mb-none">PAYMENT</h2>\*@
                                <div class="row">
                                    <div class="col-lg-4 col-md-2 col-sm-1">

                                    </div>
                                    <div class="col-lg-4 col-md-6 col-sm-10  payment">
                                        <div id="dropin-container"></div>
                                    </div>
                                    <div class="col-lg-4 col-md-2 col-sm-1">

                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-xl-4 offset-xl-8 offset-lg-6">
                                        <div class="btn-grp d-flex justify-content-between">
                                            <button class="btn_cancel" value='Back'>Back</button>
                                            <button style="display:none" class="btn_next moveNext" id="btnPaymentNextButton">Next<img src="~/assets/images/arrow_icon.png"></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                        <div class="tab-pane cstm-form @((ViewBag.PaymentProcessed && ViewBag.IsPaymentSuccess)  ? "active" : "")  " id="document">
                            <h1>Document</h1>
                            <div class="content">
                                <p>Dear @Model.Profiles[0].Salutation @Model.Profiles[0].FirstName @Model.Profiles[0].MiddleName @Model.Profiles[0].LastName,</p>
                                <p>In this final step for IC document verification, please upload/scan your valid IC document as required by Singapore regulations.</p>
                                <p>If there are any accompanying guests sharing the room with you, please upload/scan IC for each individual.</p>

                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="user-list">
                                            <ul>
                                                @for (int i = 0; i < Model.AdultCount; i++)
                                                {
                                                    string GuestName = $"Guest {i + 1}";
                                                    int GuestID = 0;
                                                    if (Model.Profiles != null && Model.Profiles.Count > i)
                                                    {
                                                        GuestName = $"{Model.Profiles[i].FirstName} {Model.Profiles[0].MiddleName} {Model.Profiles[i].LastName}";

                                                        if (string.IsNullOrEmpty(GuestName.Trim()))
                                                        {
                                                            GuestName = $"Guest {i + 1}";
                                                        }
                                                        GuestID = Model.Profiles[i].ProfileDetailID;
                                                    }

                                                    <li class="">
                                                        <label>@GuestName</label>
                                                        <div class="pic"><img src="~/assets/images/avatar.png"></div>
                                                        <a href="#" id="guestid_@(i+1)" class="fileUpload" data-guestprofileid="@GuestID" data-upload="incomplete" data-guestid="@(i+1)"><i class="fas fa-cloud-upload-alt"></i> UPLOAD</a>
                                                    </li>
                                                }
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-lg-6 col-xl-4 offset-xl-8 offset-lg-6">
                                    <div class="btn-grp d-flex justify-content-between">
                                        @*<button class="btn_cancel" value='Back' style="display:@((ViewBag.PaymentProcessed && ViewBag.IsPaymentSuccess)  ? "none" : "block") ">Back</button>*@
                                        <button class="btn_next checkUpload">Next <img src="~/assets/images/arrow_icon.png"></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        @*<div class="tab-pane content-wrapper cstm-form" id="Questions">
                                <form id="frmDeclaration" name="frmDeclaration">
                                    <div class="question">
                                        <h1>declaration</h1>
                                        <h2 class="mb-none">declaration</h2>
                                        <div class="alert alert-warning" role="alert">
                                            In conjunction with requirements by the local authorities, Fairmont Singapore would be most appreciative if you could assist in kindly filling out this declaration.
                                        </div>
                                        @{
                                            int QuestionIndex = 1;
                                        }
                                        @foreach (var question in Model.Questions)
                                        {
                                            <div class="qs">

                                                @if (question.QuestionType == "Radio")
                                                {
                                                    <p>
                                                        <span>@(QuestionIndex++)</span>
                                                        @question.Question <span class="error" style="background:white">*</span>
                                                    </p>

                                                    <div class="ans">
                                                        <div class="custom-control custom-radio custom-control-inline">
                                                            <input type="radio" id="1_Answer_@question.QuestionID" required
                                                                   name="Answer[@question.QuestionID]"
                                                                   value="Yes"
                                                                   class="custom-control-input declarationRadio">
                                                            <label class="custom-control-label" for="1_Answer_@question.QuestionID">Yes</label>
                                                        </div>
                                                        <div class="custom-control custom-radio custom-control-inline">
                                                            <input type="radio" id="2_Answer_@question.QuestionID"
                                                                   name="Answer[@question.QuestionID]" required
                                                                   value="No"
                                                                   class="custom-control-input declarationRadio">
                                                            <label class="custom-control-label" for="2_Answer_@question.QuestionID">No</label>
                                                        </div>
                                                    </div>
                                                }
                                                else if (question.QuestionType == "Checkbox")
                                                {
                                                    <div class="custom-control custom-checkbox" style="padding-left: 0">
                                                        <p>
                                                            <span>@(QuestionIndex++)</span>

                                                            <label class="custom-control-label1" for="Answer[@question.QuestionID]">
                                                                <input type="checkbox" class="custom-control-input1 passholder"
                                                                       id="Answer[@question.QuestionID]"
                                                                       name="Answer[@question.QuestionID]" onclick="enableDisableNextInput(this)">

                                                                @question.Question <span class="error" style="background:white">*</span>
                                                            </label>
                                                        </p>


                                                    </div>
                                                }
                                                else if (question.QuestionType == "NonMandate")
                                                {
                                                    <div class="custom-control custom-checkbox" style="padding-left: 0">
                                                        <p>
                                                            <span>@(QuestionIndex++)</span>

                                                            <label class="custom-control-label1" for="Answer[@question.QuestionID]">
                                                                <input type="checkbox" class="custom-control-input1 passholder"
                                                                       id="Answer[@question.QuestionID]"
                                                                       name="Answer[@question.QuestionID]" onclick="enableDisableNextInput(this)">

                                                                @question.Question <span class="error" style="background:white"></span>
                                                            </label>
                                                        </p>
                                                    </div>
                                                }
                                                else
                                                {
                                                    <p>
                                                        <span>@(QuestionIndex++)</span>
                                                        @question.Question <span class="error" style="background:white">*</span>
                                                    </p>

                                                    <div class="ans">
                                                        <textarea class="form-control" name="Answer[@question.QuestionID]" required></textarea>
                                                    </div>
                                                }

                                                @if (!string.IsNullOrEmpty(question.QuestionHint))
                                                {

                                                    <div class="msg"><p>@Html.Raw(HttpUtility.HtmlDecode(question.QuestionHint))</p></div>
                                                }

                                            </div>
                                        }

                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="button-center mt-4">
                                                    <button type="button" class="btn_next btn_blue confirmDeclaration"><i class="fas fa-check-circle"></i> Confirm</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>*@
                        <div class="tab-pane cstm-form" id="qrCode">
                            <div class="content">
                                <div class="qr">
                                    <div class="code">
                                        <img height="180" src="data:image/jpeg;base64,@ViewBag.QRcode">
                                        <p>@Model.ReservationNumber</p>

                                    </div>
                                    <p> Thank you for taking the time to complete the Pre-Arrival Registration.</p>
                                    <p> A copy of the QR code and confirmation number will be sent to your email. Please present it at the counter on the day of your stay to collect your Room Key.</p>

                                    <p>We look forward to welcoming you to Dsuite!</p>
                                    <div class="row">
                                        <div class="col-md-12 text-center mt-5">
                                            @*<div class="buttonwrapper">
                                                    <ul>
                                                        <li><a class="apple" href="#"></a></li>
                                                        <li><a class="google" href="#"></a></li>
                                                    </ul>
                                                    <a href="#">Save to Photo Library</a>
                                                </div>*@
                                            @*<img src="data:image/jpeg;base64,@ViewBag.CalQRcode" height="200" />*@
                                            <br /><br />
                                            <iframe id="my_iframe" style="display:none;"></iframe>

                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12 text-center ">
                                        <a href="@Url.Action("CompletePreCheckin","Home",new { ReservationID = Model.ReservationID })" class="ok_btn mt-2"><img src="~/assets/images/tick_icon.png">OK</a>
                                    </div>
                                </div>
                                <div class="address">
                                    <label>20 Merchant Road, Singapore 058281</label>
                                    <label>TEL: +65 6337 2288</label>
                                    <label>SINGAPORE - <a href="mailto:info@dotsinfosys.com">info@dotsinfosys.com</a></label>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>
<div class="modal fade cstm-modal" id="termsAndConditionModal" tabindex="-1" role="dialog" aria-labelledby="termsAndConditionModalLabel" aria-hidden="true">
    <div class="modal-dialog  modal-dialog-centered privacy-model" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="termsAndConditionModalLabel">Terms and Conditions </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="close_icon"></span>
                </button>
            </div>
            <div class="modal-body">

                <p>
                    I hereby agree to be jointly and severally liable with the person, company or association as may be indicated on this registrationcard, for all charges incurred on all accounts which I maynow or hereafter maintain with the hotel. I authorize the hotel to charge to my credit card if I choose not to check out at the frontdesk.
                </p>

                <p>
                    The hotel is a smoke-free hotel. A cleaning fee of S$275 nett per incident will be charged to a guest smoking in the room and/orwithin the hotel premises.Complimentary safe depositboxes are available in the room for the safe keeping of your valuables, I acknowledge that liability of the hotel is governed by the Innkeepers Act.
                </p>

                <p>
                    The hotel, as data controller, processes the personal data you provide in this form or during your stay
                    for the purposes of booking management, compliance with legal obligations and,based on legitimate interest,
                    for marketing activities and the improvement of the quality of your stays, including satisfaction enquiries.
                    Commercial communications by electronic meansare subject to your prior consent.
                </p>

                <p>
                    Yes, I wish to receive information about services and/or special promotions from Dsuite group (and its affiliates and partners) via email.
                    Send me a satisfactory survey via my email address provided in this form.
                </p>

                <div class="mt-4 text-center">
                    <button class="btnstyle blue" data-dismiss="modal" aria-label="Close">OK</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade cstm-modal" id="upgradeConditionModal" tabindex="-1" role="dialog" aria-labelledby="upgradeConditionModalLabel" aria-hidden="true">
    <div class="modal-dialog  modal-dialog-centered privacy-model" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="upgradeConditionModalLabel">Message</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="close_icon"></span>
                </button>
            </div>
            <div class="modal-body">
                <h5>Please accept the upgrade terms and conditions</h5>
                <div class="mt-4 text-center">
                    <button class="btnstyle blue" data-dismiss="modal" aria-label="Close">OK</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade cstm-modal" id="exampleModal3" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog  modal-dialog-centered upload-model" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">uPLOAD</h5>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <div class="file-up-wrap">
                            <label class="lb suces-sp"><span>1</span>Document</label>
                            <div class="custom-file">
                                <input type="file" class="custom-file-input" id="customFile11">
                                <label class="custom-file-label" for="customFile" style=" position: relative; width: 100%; margin-top: 10px;">Choose file</label>
                            </div>
                            <label class="lb"><span>2</span>Document</label>
                            <div class="custom-file">
                                <input type="file" class="custom-file-input" id="customFile12">
                                <label class="custom-file-label" for="customFile">Choose file</label>
                            </div>
                            <label class="lb"><span>3</span>Document</label>
                            <div class="custom-file">
                                <input type="file" class="custom-file-input" id="customFile13">
                                <label class="custom-file-label" for="customFile" style=" position: relative; width: 100%; margin-top: 10px;">Choose file</label>
                            </div>
                            <!--<div class="progress mb-2">
                              <div class="progress-bar bg-success" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
                            </div>-->
                        </div>
                    </div>
                </div>

                <div class="button-wrapper text-center">
                    <button class="btnstyle grey" data-dismiss="modal" aria-label="Close">Cancel</button>
                    <button class="btnUploadDoc btnstyle blue" data-guestid="" aria-label="Close">OK</button>

                </div>
                <div class="mt-4 text-center mb-4">
                    <span class="support">Supported File Type is .jpb and .png With Max Size Of 2MB</span>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade cstm-modal" id="DocumentUploadprimaryGuest" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false" aria-labelledby="DocumentUploadprimaryGuestLabel" aria-hidden="true">
    <div class="modal-dialog  modal-dialog-centered upload-model" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="DocumentUploadprimaryGuestLabel">UPLOAD</h5>
                <input type="hidden" value="" id="currentProfileID" />
                <input type="hidden" value="" id="currentGuestIndex" />
            </div>
            <div class="modal-body">
                <div class="row">

                    <div class="message" id="upgradeTerms" style="margin:0;text-align:left">
                        <p>To ensure a smooth check-in process at the hotel, please follow the instructions below carefully, and upload all information in the required specifications:</p>
                        <ul>
                            <li>For Singaporeans and Permanent Residents, please upload the front and back of your valid Identity Card separately.</li>
                            <li>For non-residents, please upload an image of the information page from your valid passport.</li>
                            <li> Images should be uploaded in landscape orientation, and must be clear and legible.</li>
                            <li>All uploaded images are required in JPEG or PNG format, and the size of each image should not exceed 2MB.</li>
                        </ul>

                        @*1. For Singaporeans & Permanent Residents, please upload the front and back of your Identity Card separately.<br>
                            2. For non-residents, please upload an image of the information page from your passport.*@

                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="file-up-wrap">
                            <label class="lb suces-sp"><span>1</span>Document</label>
                            <div class="custom-file">
                                <div class="row" style="margin:auto">
                                    <img src="" id="imgprimaryDoc1" class="img-fluid " style="display: none;margin: auto;height: 200px;" />
                                </div>
                                <input type="file" class="custom-file-input docUploadFile" id="primaryDoc1">
                                <label class="custom-file-label" for="customFile" style="width: 100%;margin-top: -30px;position: relative;">Choose file</label>
                                <div id="primaryDoc1_alert" class="row alert-success alert" style="margin: 0px; padding: 10px; margin-top: -22px;display: none">
                                    <span class="" style="display:none">document not validated</span>
                                </div>
                            </div>
                            <br />
                            <br />
                            <br />
                            <label class="lb"><span>2</span>Document</label>
                            <div class="custom-file">
                                <div class="row" style="margin:auto">
                                    <img src="" id="imgprimaryDoc2" class="img-fluid " style="display:none;margin: auto;height: 200px;" />
                                </div>
                                <input type="file" class="custom-file-input docUploadFile" id="primaryDoc2" disabled>
                                <label class="custom-file-label" for="customFile" style="width: 100%;margin-top: -30px;position: relative;">Choose file</label>
                                <div id="primaryDoc2_alert" class="row alert-success alert" style="margin: 0px; padding: 10px; margin-top: -22px;display:none">
                                    <span class="display:none">document not validated</span>
                                </div>
                            </div>
                            <label class="lb" style="display:none"><span>3</span>Document</label>
                            <div class="custom-file" style="display:none">
                                <div class="row" style="margin:auto">
                                    <img src="" id="imgprimaryDoc3" class="img-fluid " style="display:none;margin: auto;height: 200px;" />
                                </div>
                                <input type="file" class="custom-file-input  docUploadFile" id="primaryDoc3">
                                <label class="custom-file-label" for="customFile" style="width: 100%;margin-top: -30px;position: relative;">Choose file</label>
                                <span class="" style="display: none">document not validated</span>
                            </div>
                            <br />
                            <br />
                            <!--<div class="progress mb-2">
                              <div class="progress-bar bg-success" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
                            </div>-->
                        </div>
                    </div>
                </div>

                <div class="button-wrapper text-center">
                    <button class="btnstyle " data-dismiss="modal" aria-label="Close" onclick="resetDocumentInfo(); clearFileUpload();">Cancel</button>
                    <button class="btnstyle blue btnUploadPrimaryDoc" data-guestid="1">OK</button>

                </div>
                <!--
                                <div class="mt-4 text-center mb-4">
                                    <span class="support"> All uploaded images are required in JPEG or PNG format, and the size of each image should not exceed 2MB.</span>
                                </div>
                -->
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="upsellModal" tabindex="-1" role="dialog" aria-labelledby="upsellModalLabel" aria-hidden="true">
    <div class="modal-dialog hotel-view modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <div class="hotel-details">
                    <div class="row">
                        <div class="col-md-5">
                            <div class="image-wrap">
                                <img class="img-fluid" src="" id="upsellModalImg">
                            </div>
                        </div>
                        <div class="col-md-7">
                            <div class="logosm">
                                <h2 id="upsellModalPackageName"></h2>
                            </div>
                            <p id="upsellModaldescription"></p>
                            <span class="amount" id="upsellModalAmount"></span>
                            <span class="amountCondition">per room per night</span>
                            <div class="row upsell-amount-description">
                                <span>Price stated is inclusive of 10% service charge and prevailing government taxes.</span>
                            </div>

                            <div class="btn-grp upsellconfirmDiv">
                                <button class="btn_cancel" id="upsellDetailCancelButton" onclick="cancelPackageDetailPopup(this)" data-dismiss="modal" data-packageID="">Cancel</button>  @*data-toggle="modal" data-target="#ConfirmCancelUpsell"*@
                                <button class="btn_next" onclick="confirmPackage(this)" id="upsellConfirmButton" data-packageID="" data-upselltype="">
                                    <i class="fas fa-check-circle"></i> Request
                                </button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="ConfirmCancelUpsell" tabindex="-1">
    <div class="modal-dialog confirm modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <div class="hotel-details">
                    <div class="row">
                        <div class="col-md-12 text-center">
                            <p>Are you sure you want to discard this option?</p>
                            <div class="button-wrapper text-center mt-4">
                                <button class="btnstyle grey" data-dismiss="modal" data-toggle="modal" data-target="#upsellModal">No</button>
                                <button class="btnstyle blue" data-dismiss="modal" data-packageID="" data-upselltype="" id="upsellCancelButton" onclick="cancelPackage(this)"><i class="fas fa-check-circle"></i> Yes</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade cstm-modal" id="paymentAmountConfirmationModal_old" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false" aria-labelledby="paymentAmountConfirmationModalLabel" aria-hidden="true">
    <div class="modal-dialog  modal-dialog-centered upload-model" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="paymentAmountConfirmationModalLabel">confirmation</h5>
            </div>
            <div class="modal-body">
                <div class="quest card-quest">
                    <h5>Please verify your preauthorisation details </h5>
                    <div class="card-det" style="color:black">
                        <div class="row">
                            <div class="col-md-1"></div>
                            <div class="col-md-10 ">
                                <div class="payment-details">
                                    <h3>PREAUTHORISATION DETAILS</h3>
                                    <div class="form-group row">
                                        <label class="col-7 col-lg-4 col-xl-5">AMOUNT</label>
                                        <div class="col-5 col-lg-8 col-xl-7">
                                            <span id="spanRoomRate1" style="text-shadow: none;">SGD 220</span>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="col-7 col-lg-4 col-xl-5">Incidental Charges</label>
                                        <div class="col-5 col-lg-8 col-xl-7">
                                            <span id="spanIncidential1" style="text-shadow: none;">SGD 100</span>
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="form-group row">
                                        <label class="col-7 col-lg-4 col-xl-5">Total</label>
                                        <div class="col-5 col-lg-8 col-xl-7">
                                            <span id="spanTotalAmount1" style="text-shadow: none;">SGD 320<span style="text-shadow: none;">(Inclusive of Charges to Tax)</span></span>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-1"></div>
                        </div>
                    </div>

                    <div class="btns">
                        <button class="no" data-dismiss="modal" aria-label="Close">No</button>
                        <button class="yes" data-dismiss="modal" data-toggle="modal" onclick="proceedWithPayment()">Yes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="paymentAmountConfirmationModal" tabindex="-1" role="dialog" aria-labelledby="paymentAmountConfirmationModalLabel" aria-hidden="true">
    <div class="modal-dialog bill-view modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="paymentAmountConfirmationModalLabel">Please verify your preauthorisation details</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="close_icon"></span>
                </button>
            </div>
            <div class="modal-body">
                <div class="cstm-payment">
                    <h4 id="idPaymentTitleLable">PREAUTHORISATION DETAILS</h4>
                    <div class="form-group row">
                        <label class="col-7 col-lg-4 col-xl-5">AMOUNT</label>
                        <div class="col-5 col-lg-8 col-xl-7">
                            <span id="spanRoomRate">SGD 220</span>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-7 col-lg-4 col-xl-5">Incidental Charges</label>
                        <div class="col-5 col-lg-8 col-xl-7">
                            <span id="spanIncidential">SGD 100</span>
                        </div>
                    </div>
                    <hr>
                    <div class="form-group total row">
                        <label class="col-7 col-lg-4 col-xl-5">Total</label>
                        <div class="col-5 col-lg-8 col-xl-7">
                            <span id="spanTotalAmount">SGD 0.00 <span style="text-shadow: none;">(Inclusive of Charges to Tax)</span></span>
                        </div>
                    </div>
                </div>
                <div class="button-wrapper text-center mt-3 mb-3">
                    <button class="btnstyle grey" data-dismiss="modal" aria-label="Close">No</button>
                    <button class="btnstyle blue" data-guestid="" onclick="proceedWithPayment()">Yes</button>

                </div>
            </div>
        </div>
    </div>
</div>


@section Scripts{
    <script src="~/assets/js/adyenFunctions.js"></script>
    <script>
        var upselAvailable="@(PackageList.Count > 0)"
    </script>

    
    <script src="~/assets/js/main.js"></script>
    @*<script src="~/assets/js/documentUpload.js"></script>*@
    <script src="~/assets/js/wizard.js"></script>
    @*<script src="~/assets/js/app.js"></script>*@
    <script src="~/assets/js/signature_pad.umd.js"></script>
    <script>
        //function moveToNextTab(currentTab) {
        //    var $parentDiv = $(currentTab).parents('div.tab-pane');
        //    var currentTabIndex = $('.tab-pane').index($parentDiv);
        //    var nextTab = $parentDiv.next();
        //    if (nextTab.length > 0) {
        //        $parentDiv.removeClass('active');
        //        $parentDiv.next().addClass('active');
        //        setActiveTab(+currentTabIndex + 1);
        //    }
        //    $("html, body").animate({ scrollTop: 0 }, "slow");
        //}
        function moveToNextTab1(currentTab) {
           
                setActiveTab(2);
            
            $("html, body").animate({ scrollTop: 0 }, "slow");
        }
        function movePrevTab(currentTab) {
            var $parentDiv = $(this).parents('div.tab-pane');
            var currentTabIndex = $('.tab-pane').index($parentDiv);
            var nextTab = $parentDiv.prev();
            if (nextTab.length > 0) {
                $parentDiv.removeClass('active');
                $parentDiv.prev().addClass('active');
                setActiveTab(+currentTabIndex - 1);
            }
            $("html, body").animate({ scrollTop: 0 }, "slow");
        }


        $('.moveNext').on('click', function () {
            moveToNextTab(this);
        });


        $('.movePrev').on('click', function () {
            movePrevTab(this);
        });


        function enableDisableNextInput(obj) {
            if ($(obj).is(':checked')) {
                $(':input:eq(' + ($(':input').index(obj) + 1) + ')').parents('div.qs').show();
                $(':input:eq(' + ($(':input').index(obj) + 2) + ')').parents('div.qs').show();

                $(':input:eq(' + ($(':input').index(obj) + 1) + ')').attr('disabled', false);
                $(':input:eq(' + ($(':input').index(obj) + 2) + ')').attr('disabled', false);
            }
            else {
                $(':input:eq(' + ($(':input').index(obj) + 1) + ')').parents('div.qs').hide();
                $(':input:eq(' + ($(':input').index(obj) + 2) + ')').parents('div.qs').hide();

                $(':input:eq(' + ($(':input').index(obj) + 1) + ')').attr('disabled', true);
                $(':input:eq(' + ($(':input').index(obj) + 2) + ')').attr('disabled', true);
            }
        }
        enableDisableNextInput(document.getElementsByClassName('passholder')[0]);



        function clearAndRemoveAllPackage(packageID) {

            selectedUpsellPackage = selectedUpsellPackage.filter(function (value, index, arr) {
                return value == packageID;
            });

            $('.tick').each(function () {
                if ($(this).data('upselltype') == "Upsell") {
                    $(this).hide();
                }
            });
        }

        function cancelPackageDetailPopup(obj) {

            var packageid = $(obj).data('packageID');

            if (selectedUpsellPackage.indexOf(packageid) >= 0) {
                $('#ConfirmCancelUpsell').modal('show');
            }
            else if (selectedSpecialPackage.indexOf(packageid) >= 0) {
                $('#ConfirmCancelUpsell').modal('show');
            }
            else {
                $('#upsellModal').modal('hide');
            }

        }

        function savePackages(btn) {

            var packages = selectedUpsellPackage.concat(selectedSpecialPackage)
            if (selectedUpsellPackage.length > 0) {
                var upgradTerms = $('#upgradeTermsCheckbox').is(':checked');
                if (!upgradTerms) {
                    $('#customMessageModalMessage').html('Please accept the upgrade terms and conditions')
                    $('#customMessageModal').modal('show');
                    return;
                }
            }

            const data = new FormData();
            data.append('ReservationID', $('#ReservationID').val());

            TotalSpecialCharges = 0;
            $(selectedSpecialPackage).each(function (i, p) {
                var packageAmount = $('div .' + p).find('.packageAmount').val();
                TotalSpecialCharges += +packageAmount;
            });

            if ((+TotalSpecialCharges + +TotalRoomRate) > 0) {
                $('#spanTotalCharges').html('SGD ' + (+TotalSpecialCharges + +TotalRoomRate).toFixed(2) + "<span> (Inclusive of 10% service charge and prevailing government taxes)</span>");
            }
            else {
                $('#spanTotalCharges').html('--');
            }
            debugger;
            data.append('Packages', packages)
            $('.loader-screen').fadeIn(100);
            fetch(BaseURL + '/Home/savePackages', {
                method: "POST",
                body: data,
            }).then(response => response = response.json()).then(response => {
               moveToNextTab(btn);
              
                $('.loader-screen').fadeOut(1000);
            });
           
        }

        function showUpsellPopup(obj, type) {

            var description = $(obj).parent('div').find('.packageDesc').val();
            var PackageAmount = $(obj).parent('div').find('.packageAmount').val();
            var upsellImage = $(obj).parent('div').find('.upsellImage').val();
            var upsellPackageName = $(obj).parent('div').find('.upsellPackageName').val();
            var packageID = $(obj).parent('div').find('.packageID').val();
            var packageUnits = $(obj).parent('div').find('.packageUnits').val();


            $('#upsellModalPackageName').html(upsellPackageName)
            $('#upsellModalImg').attr('src', upsellImage)
            $('#upsellModalAmount').html('SGD ' + PackageAmount + " <span> nett</span>")
            $('.amountCondition').html(packageUnits)

            $('#upsellModaldescription').empty().html(description)

            $('#upsellConfirmButton').data('upselltype', type);
            $('#upsellConfirmButton').data('packageID', packageID);
            $('#upsellCancelButton').data('upselltype', type);
            $('#upsellCancelButton').data('packageID', packageID);
            $('#upsellDetailCancelButton').data('packageID', packageID);



            $('#upsellModal').modal('show');
        }

        function confirmPackage(obj) {

            var packageID = $(obj).data('packageID');
            var type = $(obj).data('upselltype');
            if (type == "Upsell") {
                if (!selectedUpsellPackage.includes(packageID)) {
                    selectedUpsellPackage.push(packageID);
                }

                clearAndRemoveAllPackage(packageID);
            }
            else {
                if (!selectedSpecialPackage.includes(packageID)) {
                    selectedSpecialPackage.push(packageID)
                }
            }


            $('div.' + packageID).find('.tick').css('z-index', '1');
            $('div.' + packageID).find('.tick').show();
            $('#upsellModal').modal('hide');

            showHideUpsellTerms();


        }


        function showHideUpsellTerms() {
            if (selectedUpsellPackage.length > 0) {
                $('#upgradeTerms').show();
            }
            else {
                $('#upgradeTerms').hide();
            }

            if (selectedSpecialPackage.length > 0) {
                $('#upgradeTermsSpecials').show();
            }
            else {
                $('#upgradeTermsSpecials').hide();
            }
        }

        function cancelPackage(obj) {

            $('#ConfirmCancelUpsell').modal();

            var packageID = $(obj).data('packageID');
            var type = $(obj).data('upselltype');

            if (type == "Upsell") {
                selectedUpsellPackage = selectedUpsellPackage.filter(function (value, index, arr) {
                    return value != packageID;
                });
            }
            else {
                selectedSpecialPackage = selectedSpecialPackage.filter(function (value, index, arr) {
                    return value != packageID;
                });
            }

            $('div.' + packageID).find('.tick').css('z-index', '1');
            $('div.' + packageID).find('.tick').hide();
            $('#upsellModal').modal('hide');


            if (selectedUpsellPackage.length > 0) {
                $('#upgradeTerms').show();
            }
            else {
                $('#upgradeTerms').hide();
            }

            if (selectedSpecialPackage.length > 0) {
                $('#upgradeTermsSpecials').show();
            }
            else {
                $('#upgradeTermsSpecials').hide();
            }



        }

        $('select.selectCountry').on('change', function () {
            $('#frm_guestdetails').validate();
            LoadStateByCountry(this.value)

        });

        function SaveReservationAndMoveNext(btn) {
            $('#frm_guestdetails').validate();
            if ($('#frm_guestdetails').valid()) {

                $('.loader-screen').fadeIn(100);
                const data = new URLSearchParams();
                for (const pair of new FormData(document.getElementById('frm_guestdetails'))) {
                    data.append(pair[0], pair[1]);
                }

                fetch(BaseURL + '/Home/UpdateReservation', {
                    method: "POST",
                    body: data,
                }).then(response => response = response.json()).then(response => {
                    moveToNextTab(btn);
                    $('.loader-screen').fadeOut(1000);
                });
            }
        }

        function SavePolicies(btn) {

            const data = new FormData();
            var terms = $('#IsTermsAndConditionAccepted').is(':checked')
            var fines = $('#chkFine').is(':checked')

            if (terms) {
                if (fines) {

                    data.append('IsTermsAndConditionAccepted', terms);
                    data.append('ReservationID', $('#ReservationID').val());
                    if (signaturePad.isEmpty()) {
                        $('#customMessageModalMessage').html("Please provide a signature first.");
                        $('#customMessageModal').modal('show');


                        return false;
                    } else {
                        var dataURL = signaturePad.toDataURL();
                        var strImage = dataURL.replace(/^data:image\/[a-z]+;base64,/, "");
                        data.append('Base64Signature', strImage);
                    }

                    $('.loader-screen').fadeIn(100);
                    fetch(BaseURL + '/Home/UpdatePolicies', {
                        method: "POST",
                        body: data,
                    }).then(response => response = response.json()).then(response => {
                        moveToNextTab(btn);
                        $('.loader-screen').fadeOut(1000);
                    });
                }
                else {

                    $('#customMessageModalMessage').html("Please agree to the Smoking Policy");
                    $('#customMessageModal').modal('show');
                }

            }
            else {
                $('#customMessageModalMessage').html("Please accept terms and conditions.");
                $('#customMessageModal').modal('show');
            }
        }

        $('.confirmDeclaration').on('click', function (e) {
            e.preventDefault();
            var btn = $(this);

            if ($('#frmDeclaration').valid()) {

                const data = new URLSearchParams();
                for (const pair of new FormData(document.getElementById('frmDeclaration'))) {
                    data.append(pair[0], pair[1]);
                }
                data.append('ReservationID', $('#ReservationID').val());
                $('.loader-screen').fadeIn(100);
                fetch(BaseURL + '/Home/SaveDeclaration', {
                    method: "POST",
                    body: data,
                }).then(response => response = response.json()).then(response => {
                    moveToNextTab(btn);
                    $('.loader-screen').fadeOut(1000);
                });
            }

        });

        function LoadStateByCountry(countryID) {
            $.ajax({
                url: BaseURL + "/api/PortalService/GetStateByCountryID/",
                data: {
                    "CountryID": countryID
                },
                type: "GET",
                dataType: "json",
                success: function (data) {
                    var state = $('select.state');
                    $(state).find('option').remove().end();
                    $(state).append("<option>Select State</option>");
                    $(data).each(function (i, obj) {
                        $(state).append("<option value='" + obj.StateMasterID + "'>" + obj.Statename + "</option>");
                    });
                    $(state).selectpicker('refresh');
                },
                error: function (data) {
                    console.error(data);
                }
            });
        }

        function pageLoad() {

            if ($('#MembershipNo').val() != '') {
                $('#IsMembershipRequested').attr('disabled', true);
                $('#MembershipNo').attr('readonly', true);
            }
            else {
                $('#IsMembershipRequested').attr('disabled', false);
                $('#MembershipNo').attr('readonly', false);
            }

            if ($('#IsMembershipRequested').is(':checked')) {
                $('#MembershipNo').attr('readonly', true);
            }

        }

        pageLoad();

    </script>

    <script>

        $('.tick').each(function () {
            // $(this).hide();
        })


        function setActiveTab(index) {
            $('.tabs').each(function (i, e) {
                $(this).removeClass('active');
                if (i <= index) {
                    $(this).addClass('active');
                }
            });
        }

        showHideUpsellTerms();

        $('.fileUpload').on('click', function (e) {
            e.preventDefault();
            var upload1 = $(this).data('upload');
            var guestprofileid = $(this).data('guestprofileid');
            var currentGuestIndex = $(this).data('guestid');
            $('#currentProfileID').val(guestprofileid);
            $('#currentGuestIndex').val(currentGuestIndex);

            $('.spanDocumentNotValidated').each(function (i, o) {
                $(o).html('');
                $(o).hide();
            });

            $('#imgprimaryDoc1').hide();
            $('#imgprimaryDoc2').hide();
            $('#imgprimaryDoc3').hide();

            $('#imgprimaryDoc1').attr('src', '');
            $('#imgprimaryDoc2').attr('src', '');
            $('#imgprimaryDoc3').attr('src', '');


            if (upload1 != "completed") {
                $('#DocumentUploadprimaryGuest').modal('show');
            }
        });


        $('.btnUploadPrimaryDoc').on('click', function (e) {

            uploadDocumentToCloud();

            //if (checkFileExtensions()) {
            //    uploadDocumentToCloud()
            //}
            //else {
            //    $('#customMessageModalMessage').html("Invalid file format selected");
            //    $('#customMessageModal').modal('show');
            //}
        });

        $('.checkUpload').on('click', function (e) {
            isFileUploadComplete = true;
            $('.fileUpload,.fileUpload1,.fileUpload2').each(function (i, obj) {
                if ($(this).data('upload') == "incomplete") {
                    isFileUploadComplete = false;
                }
            });

            if (!isFileUploadComplete) {

                $('#customMessageModalMessage').html("Please upload guest document.");
                $('#customMessageModal').modal('show');

            }
            else {
                moveToNextTab($(this));
            }
        });

        function checkFileExtensions() {

            var isValid = true;
            $('.docUploadFile').each(function (i, o) {
                var filename = $(this).val();
                if (filename) {
                    var extension = filename.replace(/^.*\./, '');

                    if (extension == filename) {
                        extension = '';
                    }
                    else {
                        extension = extension.toLowerCase();
                    }

                    if (extension == 'jpg' || extension == 'jpeg' || extension == 'png') {

                    }
                    else {
                        isValid = false;
                    }
                }
            });
            return isValid;
        }

        var documentInformation = {
            documentType: "",
            documentNumber: "",
            issueDate: "",
            expiryDate: "",
            gender: "",
            firstName: "",
            middleName: "",
            lastName: "",
            nationality: "",
            issueCountry: "",
            birthDate: "",
            faceImage: ""
        };

        function uploadDocumentToCloud() {

            var Img1 = $('#imgprimaryDoc1').attr('src');
            var Img2 = $('#imgprimaryDoc2').attr('src');

            var profileDetailID = $('#currentProfileID').val();

            var guestID = $('#currentGuestIndex').val();

            if (Img1 != '') {
                var formdata = new FormData();
                formdata.append("Doc1Base64", Img1.replace(/^data:image.+;base64,/, ''));
                formdata.append("Doc2Base64", Img2.replace(/^data:image.+;base64,/, ''));


                //if ((documentInformation.documentType == "Identity Card" || documentInformation.documentType == "NID") ||
                //    (documentInformation.documentType && documentInformation.issueCountry == "SGP"))
                if (documentInformation.issueCountry == "SGP" && documentInformation.documentType == "IDENTITY_CARD") {
                    if (Img1 != '' && Img2 != '') {

                    }
                    else {
                        $('#customMessageModalMessage').html('Please upload other side of the document');
                        $('#customMessageModal').modal('show');
                        return;
                    }
                }

                formdata.append('ReservationID', $('#ReservationID').val());
                formdata.append('ProfileDetailID', profileDetailID);
                formdata.append('documentInformation', JSON.stringify(documentInformation));

                $('.loader-screen').fadeIn(100);

                fetch(BaseURL + '/Home/UploadDocument', {
                    method: "POST",
                    body: formdata,
                }).then(response => response = response.json()).then(response => {

                    resetDocumentInfo();

                    clearFileUpload();

                    $('.loader-screen').fadeOut(500);

                    setTimeout(function () {

                        $('#DocumentUploadprimaryGuest').modal('hide');
                        $('#guestid_' + guestID).parent('li').addClass("sucess");
                        $('#guestid_' + guestID).data('upload', 'completed');
                        $('#guestid_' + guestID).html('<i class="fas fa-check-circle"></i> COMPLETE');
                    }, 1000);
                });
            }
            else {
                $('#customMessageModalMessage').html("Please select file.");
                $('#customMessageModal').modal('show');
            }
        }

        const validateDocument = (document) => httpPost(BaseURL + '/api/portalservice/ValidateDocument', document).then(response => {
            return response;
        });

        const ValidateDocumentIssueCountry = (docType, issueCountry) => httpPost(BaseURL + '/Home/ValidateDocumentIssueCountry?idType=' + docType + '&issueCountry=' + issueCountry).then(response => {
            return response;
        });

        const validateDocumentDirect = (document) => httpPost(AdaptorAPIBaseURL + '/OCRProcessDocument', document).then(response => {
            return response;
        });

        const getProcessedImage = (transaction) => httpPost(AdaptorAPIBaseURL + '/GetProcessedImage', transaction).then(response => {
            return response;
        });

        const GetProcessedDocumentType = (transaction) => httpPost(AdaptorAPIBaseURL + '/GetProcessedDocumentType', transaction).then(response => {
            return response;
        });

        const GetProcessedDocumentFaceImage = (transaction) => httpPost(AdaptorAPIBaseURL + '/GetProcessedDocumentFaceImage', transaction).then(response => {
            return response;
        });

        const upload = document.getElementById('primaryDoc1');

        const upload2 = document.getElementById('primaryDoc2');

        function blobToDataURL(blob, callback) {
            var a = new FileReader();
            a.onload = function (e) { callback(e.target.result); }
            a.readAsDataURL(blob);
        }


        //uploadold.addEventListener("change", (evt) => {
        //    processDocument(evt);
        //}, false);

        //upload2old.addEventListener("change", (evt) => {
        //    processDocument(evt);
        //}, false);



        upload.addEventListener('change', (evt) => {
            const files = [...evt.target.files]
            processDocumentNew(files, evt.target);
        }, false)

        upload2.addEventListener('change', (evt) => {
            const files = [...evt.target.files]
            processDocumentNew(files, evt.target);

        }, false)

        function processDocumentNew(files, target) {
            var fileControl = $(target);

            var fileName = $(fileControl).val().split("\\").pop();
            var imgPreview = $(fileControl).parent('div').find('img');
            var filextension = fileName.split(".");
            var documentReadStatus = $(fileControl).parent('div').find(".alert");
            $(documentReadStatus).hide();

            if ($('.docUploadFile').index(fileControl) == 0) {
                /*resetDocumentInfo();*/

                $('#primaryDoc2').val('');
                $('#primaryDoc2').siblings(".custom-file-label").removeClass("selected").html('Choose file');
                $('#primaryDoc2').parent('div').find('img').attr('src', '');
                $('#primaryDoc2').parent('div').find('img').hide();
                $('#primaryDoc2').attr('disabled', false);
                var primaryDoc2alert = $('#primaryDoc2').parent('div').find(".alert")
                $(primaryDoc2alert).hide();
            }


            var filext = "." + filextension.slice(-1)[0];
            var valid = [".jpg", ".png", ".jpeg"];

            if (valid.indexOf(filext.toLowerCase()) == -1) {

                $('#customMessageModalMessage').html('File type not supported');
                $('#customMessageModal').modal('show');

                $(fileControl).val('');
                $(fileControl).siblings(".custom-file-label").removeClass("selected").html('Choose file');
                $(fileControl).parent('div').find('img').attr('src', '');
                $(fileControl).parent('div').find('img').hide();
                $(documentReadStatus).hide();
            }
            else {
                $('.loader-screen').fadeIn(100);
                compress.compress(files, {
                    size: 2,
                    quality: 0.75,
                    maxWidth: 1920,
                    maxHeight: 1920,
                    resize: true
                }).then((images) => {
                    const imgout = images[0]
                    var imageBase64 = imgout.data;

                    validateDocumentDirect({
                        RequestObject: {
                            Base64Image: imageBase64,
                            ImageFormat: ".jpg",
                            OCRURL: OCRAPIBaseURL
                        }

                    }).then(response => {
                        if (response.result) {
                            assignDocumentInfo(response);

                            var transactionIDRequestObj = {
                                "RequestObject": response.responseData.TransactionID
                            };

                            if (!response.responseData.IsExpired) {

                                if (response.responseData && response.responseData.fullImage) {
                                    $(imgPreview).attr('src', "data:image/jpg;base64," + response.responseData.fullImage);
                                    $(imgPreview).show();
                                }
                                else {
                                    $(imgPreview).attr('src', `${imgout.prefix}${imgout.data}`);
                                    $(imgPreview).show();
                                }

                                if (response.responseData.idType != "PASSPORT" || response.responseData.idType == "") {
                                    $('#primaryDoc2').attr('disabled', false);
                                }
                                else {
                                    $('#primaryDoc2').attr('disabled', true);
                                }

                                ValidateDocumentIssueCountry(response.responseData.documentTypeCode, response.responseData.issueCountryCode).then(docIssueCountryResponse => {

                                    if (docIssueCountryResponse.result) {
                                        $('.loader-screen').fadeOut(100);
                                        //$(documentReadStatus).html('document validated');
                                        //$(documentReadStatus).hide();
                                        //$(documentReadStatus).removeClass('alert-success');
                                        //$(documentReadStatus).removeClass('alert-danger');
                                        //$(documentReadStatus).addClass('alert-success');
                                    }
                                    else {
                                        $('.loader-screen').fadeOut(100);
                                        //$(documentReadStatus).html('document not validated');
                                        //$(documentReadStatus).hide();
                                        //$(documentReadStatus).removeClass('alert-success');
                                        //$(documentReadStatus).removeClass('alert-danger');
                                        //$(documentReadStatus).addClass('alert-danger');
                                    }
                                });

                                //getProcessedImage(transactionIDRequestObj).then(response1 => {

                                //    if (response1.responseData && response1.responseData[0].Base64ImageString) {
                                //        $(imgPreview).attr('src', "data:image/jpg;base64," + response1.responseData[0].Base64ImageString);
                                //        $(imgPreview).show();
                                //    }
                                //    else {
                                //        $(imgPreview).attr('src', `${imgout.prefix}${imgout.data}`);
                                //        $(imgPreview).show();
                                //    }

                                //    GetProcessedDocumentType(transactionIDRequestObj).then(response2 => {


                                //        if (response2.responseData.documentTypeCode != "Passport" || response2.responseData.documentTypeCode == "") {
                                //            $('#primaryDoc2').attr('disabled', false);
                                //        }
                                //        else {
                                //            $('#primaryDoc2').attr('disabled', true);
                                //        }

                                //        documentInformation.documentType = response2.responseData.documentTypeCode;
                                //        documentInformation.issueCountry = response2.responseData.issueCountryCode;


                                //        GetProcessedDocumentFaceImage(transactionIDRequestObj).then(response3 => {
                                //            documentInformation.faceImage = response3.responseData;
                                //        });

                                //        ValidateDocumentIssueCountry(response2.responseData.documentTypeCode, response2.responseData.issueCountryCode).then(docIssueCountryResponse => {

                                //            if (docIssueCountryResponse.result) {
                                //                $('.loader-screen').fadeOut(100);
                                //                //$(documentReadStatus).html('document validated');
                                //                //$(documentReadStatus).hide();
                                //                //$(documentReadStatus).removeClass('alert-success');
                                //                //$(documentReadStatus).removeClass('alert-danger');
                                //                //$(documentReadStatus).addClass('alert-success');
                                //            }
                                //            else {
                                //                $('.loader-screen').fadeOut(100);
                                //                //$(documentReadStatus).html('document not validated');
                                //                //$(documentReadStatus).hide();
                                //                //$(documentReadStatus).removeClass('alert-success');
                                //                //$(documentReadStatus).removeClass('alert-danger');
                                //                //$(documentReadStatus).addClass('alert-danger');
                                //            }
                                //        });
                                //    });
                                //});
                            }
                            else {
                                $('.loader-screen').fadeOut(100);
                                $(documentReadStatus).html('document expired')
                                $(documentReadStatus).hide();
                                $(documentReadStatus).removeClass('alert-success');
                                $(documentReadStatus).removeClass('alert-danger');
                                $(documentReadStatus).addClass('alert-danger');
                            }

                        }
                        else {
                            $(imgPreview).attr('src', `${imgout.prefix}${imgout.data}`);
                            $(imgPreview).show();
                            $('.loader-screen').fadeOut(100);
                            //$(documentReadStatus).html('document not validated');
                            //$(documentReadStatus).hide();
                            //$(documentReadStatus).removeClass('alert-success');
                            //$(documentReadStatus).removeClass('alert-danger');
                            //$(documentReadStatus).addClass('alert-danger');
                        }

                    });

                });

                $(fileControl).siblings(".custom-file-label").addClass("selected").html(fileName);
            }
        }

        $(".custom-file-input1").on("change", function () {

            var fileControl = $(this);
            var fileName = $(this).val().split("\\").pop();
            var img = $(this).parent('div').find('img');
            var filextension = fileName.split(".");
            var documentReadStatus = $(this).parent('div').find("div .alert");
            $(documentReadStatus).hide();


            if ($('.docUploadFile').index(fileControl) == 0) {
                /*resetDocumentInfo();*/
            }

            var filext = "." + filextension.slice(-1)[0];
            var valid = [".jpg", ".png", ".jpeg"];

            if (valid.indexOf(filext.toLowerCase()) == -1) {

                // file format not supported
                $('#customMessageModalMessage').html('File type not supported');
                $('#customMessageModal').modal('show');
                $(this).val('');
                $(this).siblings(".custom-file-label").removeClass("selected").html('Choose file');
                $(this).parent('div').find('img').attr('src', '');
                $(this).parent('div').find('img').hide();
                return;
            }
            else {



                // read the image file as a data URL.
                // reader.readAsDataURL(this.files[0]);
                $(this).siblings(".custom-file-label").addClass("selected").html(fileName);

            }

        });
        //file upload
        $(".custom-file-input").on("change", function () {
            var fileName = $(this).val().split("\\").pop();
            $(this).siblings(".custom-file-label").addClass("selected").html(fileName);
        });


        function assignDocumentInfo(response) {
            if (!documentInformation.documentType)
                documentInformation.documentType = response.responseData.idType;
            if (!documentInformation.documentNumber)
                documentInformation.documentNumber = response.responseData.documentNumber;
            if (!documentInformation.issueDate)
                documentInformation.issueDate = response.responseData.issueDate;
            if (!documentInformation.expiryDate)
                documentInformation.expiryDate = response.responseData.expiryDate;
            if (!documentInformation.gender)
                documentInformation.gender = response.responseData.gender;
            if (!documentInformation.firstName)
                documentInformation.firstName = response.responseData.firstName;
            if (!documentInformation.middleName)
                documentInformation.middleName = response.responseData.middleName;
            if (!documentInformation.lastName)
                documentInformation.lastName = response.responseData.lastName;
            if (!documentInformation.nationality)
                documentInformation.nationality = response.responseData.nationality;
            if (!documentInformation.issueCountry)
                documentInformation.issueCountry = response.responseData.issueCountry;
            if (!documentInformation.faceImage)
                documentInformation.faceImage = response.responseData.faceImage;
            if (!documentInformation.documentType)
                documentInformation.documentType = response.responseData.idType;
            documentInformation.issueCountry = response.responseData.issueCountry;
            if (!documentInformation.birthDate)
                if (response.responseData.dateOfBirth != null && response.responseData.dateOfBirth != "" && response.responseData.dateOfBirth != undefined)
                    documentInformation.birthDate = response.responseData.dateOfBirth;
            if (response.responseData.birthDate != null && response.responseData.birthDate != "" && response.responseData.birthDate != undefined)
                documentInformation.birthDate = response.responseData.birthDate;
        }

        function resetDocumentInfo() {
            documentInformation = {
                documentType: "",
                documentNumber: "",
                issueDate: "",
                expiryDate: "",
                gender: "",
                firstName: "",
                middleName: "",
                lastName: "",
                nationality: "",
                issueCountry: "",
                birthDate: "",
                faceImage: ""
            };
        }

        function clearFileUpload() {
            $('#primaryDoc1').val('');
            $('#primaryDoc1').siblings(".custom-file-label").removeClass("selected").html('Choose file');
            $('#primaryDoc1').parent('div').find('img').attr('src', '');
            $('#primaryDoc1').parent('div').find('img').hide();
            $('#primaryDoc1').parent('div').find('.alert').hide();

            $('#primaryDoc2').val('');
            $('#primaryDoc2').siblings(".custom-file-label").removeClass("selected").html('Choose file');
            $('#primaryDoc2').parent('div').find('img').attr('src', '');
            $('#primaryDoc2').parent('div').find('img').hide();
            $('#primaryDoc2').parent('div').find('.alert').hide();

            $('#primaryDoc3').val('');
            $('#primaryDoc3').siblings(".custom-file-label").removeClass("selected").html('Choose file');
            $('#primaryDoc3').parent('div').find('img').attr('src', '');
            $('#primaryDoc3').parent('div').find('img').hide();
            $('#primaryDoc3').parent('div').find('.alert').hide();


            $('#primaryDoc2').attr('disabled', true);
            $('#primaryDoc3').attr('disabled', true);
        }
      





    </script>
}
